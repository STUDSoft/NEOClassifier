package main;

import java.awt.Component;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.awt.event.ActionEvent;
import java.awt.event.WindowEvent;

import javax.swing.BoxLayout;
import javax.swing.JButton;
import javax.swing.JComponent;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JTabbedPane;
import javax.swing.JTextArea;

/**
 * Launches application
 * 
 * @author Daniele Monaco
 *
 */
public class SkinAnalysis extends JFrame {
	
	/** Counts the number of patients */
	private int patientN=0;
	
	/** A tabbed pane is used to view patients */
	private JTabbedPane tabPane;
	/** The starting tab */
	private JPanel start;
	/** Button used to add patients*/
	private JButton addPatientBt;
	
	//TODO Dimensioni
	
	//for debugging
	private JTextArea msg;
	
	/**
	 * Default Constructor
	 */
	public SkinAnalysis() {

		//debugging
		msg=new JTextArea();
		msg.setText("Ciao");
		
		//creating tabs
		tabPane=new JTabbedPane();
		
		//creating starting tab
		start = new JPanel();
		start.setLayout( new BoxLayout(start, BoxLayout.Y_AXIS));
		start.add(new JTextArea("ciao"));
		
		addPatientBt=new JButton("Add Patient");
		addPatientBt.addActionListener(new java.awt.event.ActionListener(){
			public void actionPerformed(ActionEvent e){
				addPatient();
			}
		});
		
		start.add(addPatientBt);
		
		tabPane.addTab("Start", start);
		tabPane.addTab("Paziente 1", new JTextArea("wowo"));
		
		//container for all the interface
		JPanel total= new JPanel();
		total.setLayout( new BoxLayout(total, BoxLayout.Y_AXIS) );
		total.add(tabPane);
		total.add(msg);
		
		//setting up the interface
		this.getContentPane().add(total);
		this.setTitle("SkinAnalysis");
		this.setExtendedState(JFrame.MAXIMIZED_BOTH);
		this.addWindowListener( new java.awt.event.WindowAdapter(){
			public void windowClosing(WindowEvent e){
				destroy();
				System.exit(0);
			}
		});
		this.setVisible(true);
	}
	
	
	/**
	 * Closes the application
	 */
	public void destroy() {
		
	}
	
	/**
	 * Creates a new tab for a client
	 */
	private void addPatient() {
		//TODO
		patientN++;
		Component patientPanel=new PatientPanel(patientN);
		String title=new String("Patient"+patientN);
		tabPane.addTab(title, patientPanel);
		
		//customizes the title of the tab
		
		ButtonTabComponent btn=new ButtonTabComponent();
		
		int index = tabPane.indexOfTab(title);
		JPanel pnlTab = new JPanel(new GridBagLayout());
		pnlTab.setOpaque(false);
		JLabel lblTitle = new JLabel(title);
		JButton btnClose = new JButton("x");

		GridBagConstraints gbc = new GridBagConstraints();
		gbc.gridx = 0;
		gbc.gridy = 0;
		gbc.weightx = 1;

		pnlTab.add(lblTitle, gbc);

		gbc.gridx++;
		gbc.weightx = 0;
		pnlTab.add(btnClose, gbc);

		tabPane.setTabComponentAt(index, pnlTab);

		//btnClose.addActionListener(myCloseActionHandler);
	}
	
	/**
	 * Starts application interface
	 * 
	 * @param args
	 */
	public static void main(String[] args) {
		// TODO Auto-generated method stub
		System.out.println("Avvio");
		new SkinAnalysis();
	}

}
